<%= form_with(model: (@asset ? [@asset, @incident] : @incident), class: "space-y-5", local: true, data: { turbo: false }) do |form| %>      
      
  <% if @incident.errors.any? %>
    <div class="rounded-lg border border-red-200 bg-red-50 p-3 text-red-700">
      <strong><%= pluralize(@incident.errors.count, "error") %></strong> prevented saving:
      <ul class="list-disc pl-6">
        <% @incident.errors.full_messages.each do |msg| %>
          <li><%= msg %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div>
    <%= form.label :status, class: "block text-sm font-medium text-gray-700 mb-1" %>
    <div class="relative">
      <%= form.select :status,
            [["Open","open"], ["Monitoring","monitoring"], ["Resolved","resolved"]],
            {},
            class: "select" %>
      <svg class="pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-500"
           viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
        <path fill-rule="evenodd"
              d="M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.21 8.29a.75.75 0 01.02-1.08z"
              clip-rule="evenodd" />
      </svg>
    </div>
  </div>

  <div>
    <%= form.label :severity, class: "block text-sm font-medium text-gray-700 mb-1" %>
    <div class="relative">
      <%= form.select :severity,
            [["Minor","minor"], ["Moderate","moderate"], ["Major","major"], ["Critical","critical"]],
            {},
            class: "select" %>
      <svg class="pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-500"
           viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
        <path fill-rule="evenodd"
              d="M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.21 8.29a.75.75 0 01.02-1.08z"
              clip-rule="evenodd" />
      </svg>
    </div>
  </div>

  <div>
    <%= form.label :started_at %>
    <%= form.datetime_field :started_at, class: "input" %>
  </div>

  <div>
    <%= form.label :resolved_at %>
    <%= form.datetime_field :resolved_at, class: "input" %>
  </div>

  <div>
    <%= form.label :cause %>
    <%= form.text_field :cause, class: "input" %>
  </div>

  <div>
    <%= form.label :notes %>
    <%= form.text_area :notes, rows: 4, class: "textarea" %>
  </div>

  <% if @asset %>
    <%= form.hidden_field :asset_id, value: @asset.id %>
  <% else %>
    <div>
      <%= form.label :asset_id, "Asset" %>
      <%= form.collection_select :asset_id, Asset.order(:name), :id, :name, {}, class: "select" %>
    </div>
  <% end %>

  <div class="inline">
    <%= form.submit (@incident.persisted? ? "Update Incident" : "Create Incident"),
                    class: "w-full sm:w-auto rounded-md px-3.5 py-2.5 bg-blue-600 hover:bg-blue-500 text-white inline-block font-medium cursor-pointer" %>
  </div>

<% end %>
